---
title: "Compare old and new blast results"
author: "Erin Chille"
date: "1/18/2021"
output: html_document
---

Remove prior objects and load necessary tools
```{r, warning=FALSE, message=FALSE}
rm(list=ls()) # removes all prior objects

library("RColorBrewer")
library("ggplot2")
library("tidyverse")
library("ggpubr")
library("DESeq2")
```

Load in results
```{r}
hits2 <- read.table(file="2b-Epi-MZT-Enzyme-Expression/Output/Mcap_Epi_MZT_HSP_hits_100.csv", header=T, sep=",")
hits2 <- hits2 %>% distinct(Epi.gene, gene_id, .keep_all = TRUE)
hits2 <- hits2 %>% group_by(Epi.gene) %>% distinct(sstart, ssend, .keep_all = TRUE)
hits2 <- filter(hits2, bitscore>50)
hits2 <- hits2[,c(1,3,5, 12, 13)]

hits1 <- read.table(file="../Mcap_Epi_MZT_biomarker_hits_100.tsv", header=T, sep="\t")
hits1 <- hits1 %>% distinct(Epi.gene, gene_id, .keep_all = TRUE)
hits1 <- hits1 %>% group_by(Epi.gene) %>% distinct(sstart, send, .keep_all = TRUE)
hits1 <- filter(hits1, bitscore>50)
hits1 <- hits1[,c(1,3,5, 12, 13)]
```

# Epi enzymes

Subset by enzyme and compare results
```{r}
modelorg.DNMT1 <- hits1 %>% filter(Epi.gene=="DNMT1") %>% top_n(5, bitscore)
modelorg.DMNT3a <- hits1 %>% filter(Epi.gene=="DNMT3A") %>% top_n(5, bitscore)
modelorg.TET1 <- hits1 %>% filter(Epi.gene=="TET1") %>% top_n(5, bitscore)
modelorg.MBD2.3 <- hits1 %>% filter(Epi.gene=="MBD2" | Epi.gene=="MBD3") %>% top_n(5, bitscore)
modelorg.UHRF1 <- hits1 %>% filter(Epi.gene=="UHRF1") %>% top_n(5, bitscore)
modelorg.BRG1  <- hits1 %>% filter(Epi.gene=="BRG1") %>% top_n(5, bitscore)

cnidarian.DNMT1 <-  hits2 %>% filter(Epi.gene=="DNMT1") %>% top_n(5, bitscore)
cnidarian.DMNT3a <- hits2 %>% filter(Epi.gene=="DNMT3A") %>% top_n(5, bitscore)
cnidarian.TET1 <- hits2 %>% filter(Epi.gene=="TET1") %>% top_n(5, bitscore)
cnidarian.MBD2.3 <- hits2 %>% filter(Epi.gene=="MBD2" | Epi.gene=="MBD3") %>% top_n(5, bitscore)
cnidarian.UHRF1 <- hits2 %>% filter(Epi.gene=="UHRF1") %>% top_n(5, bitscore)
cnidarian.BRG1  <- hits2 %>% filter(Epi.gene=="BRG1") %>% top_n(5, bitscore)
```

All three hits look relatively the same for DNMT1 when comparing model organism and coral
```{r}
head(modelorg.DNMT1)
head(cnidarian.DNMT1)
```
The top hit is the same for DNMT3A when comparing model organism and coral. The coral search brought 1 more sig hit.
```{r}
head(modelorg.DMNT3a)
head(cnidarian.DMNT3a)
```
The top hit is the same for TET1 when comparing model organism and coral.
```{r}
head(modelorg.TET1)
head(cnidarian.TET1)
```

The top hits are the same for two MBD proteins when comparing model organism and coral.
```{r}
head(modelorg.MBD2.3)
head(cnidarian.MBD2.3)
```

The top two hits are the same for UHRF1 when comparing model organism and coral. The model organism search brought 3 more sig hits that did not match nearly as well as the top two.
```{r}
head(modelorg.UHRF1)
head(cnidarian.UHRF1)
```

The top four hits are the same for BRG1 when comparing model organism and coral. The last of the top five on both did not match.
```{r}
head(modelorg.BRG1)
head(cnidarian.BRG1)
```

The top two hits are the same for UHRF1 when comparing model organism and coral. The model organism search brought 3 more sig hits that did not match nearly as well as the top two.
```{r}
head(modelorg.UHRF1)
head(cnidarian.UHRF1)
```

# Developmental Biomarkers
Subset by enzyme and compare results
```{r}
modelorg.KAISO <- hits1 %>% filter(Epi.gene=="KAISO") %>% top_n(5, bitscore)
modelorg.SMG <- hits1 %>% filter(Epi.gene=="SMG") %>% top_n(5, bitscore)
modelorg.TBXT <- hits1 %>% filter(Epi.gene=="TBXT") %>% top_n(5, bitscore)
modelorg.SOX2 <- hits1 %>% filter(Epi.gene=="SOX2") %>% top_n(5, bitscore)
modelorg.WNT8  <- hits1 %>% filter(Epi.gene=="WNT8") %>% top_n(5, bitscore)

cnidarian.KAISO <-  hits2 %>% filter(Epi.gene=="KAISO") %>% top_n(5, bitscore)
cnidarian.SMG <- hits2 %>% filter(Epi.gene=="SMG") %>% top_n(5, bitscore)
cnidarian.TBXT <- hits2 %>% filter(Epi.gene=="TBXT") %>% top_n(5, bitscore)
cnidarian.SOX2 <- hits2 %>% filter(Epi.gene=="SOX2") %>% top_n(5, bitscore)
cnidarian.WNT8  <- hits2 %>% filter(Epi.gene=="WNT8") %>% top_n(5, bitscore)
```

The top four hits are the same for KAISO when comparing the first round of blast and the second. Both used same, but different model organism sequences. The evalues and bitscores are much lower than the other enzymess, but still significant.
```{r}
head(modelorg.KAISO)
head(cnidarian.KAISO)
```
The top 3 hits are the same for SMG when comparing model organism and coral.
```{r}
head(modelorg.SMG)
head(cnidarian.SMG)
```
The top four hits are the same for TBXT when comparing model organism and coral. The last of the top five on both did not match.
```{r}
head(modelorg.TBXT)
head(cnidarian.TBXT)
```

For the most part the top hits are the same for SOX2 proteins with some differences when comparing model organism and coral. I believe this is the first time that the top enzyme isn't the same in both searches. However, the top enzyme for the coral (which was the top by quite a bit), was also in the top five for the model organism.
```{r}
head(modelorg.SOX2)
head(cnidarian.SOX2)
```

The only gene that overlaps between these two searches is adi2mcaRNA17113_R1.
```{r}
head(modelorg.WNT8)
head(cnidarian.WNT8)
```