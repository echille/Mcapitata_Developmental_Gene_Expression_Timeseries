---
title: "Epigenetic and MZT Biomarker Expression"
author: "Erin Chille"
date: "Last updated: 2020/11/06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Set up workspace

Remove prior objects and load necessary tools
```{r, warning=FALSE, message=FALSE}
rm(list=ls()) # removes all prior objects

library("RColorBrewer")
library("ggplot2")
library("tidyverse")
library("ggpubr")
library("DESeq2")
```


Load sample Information
```{r}
sample.info <- read.csv(file="Sample_Info/RNAseq_data.csv", header=T, sep=",") #load sample info
```

Load gene count Information
```{r}
counts <- as.data.frame(read.csv("1-QC-Align-Assemble/Output/gene_count_matrix.csv", row.names="gene_id"), colClasses = double) #Load normalized expression matrix from stringtie
```


Keep only ambient treatmentinfo and count data
```{r}
dev <- c("AMB")
treatmentinfo_dev <- filter(sample.info, treatment %in% dev)
dim(treatmentinfo_dev) #rows should be 24

gcount_dev <- counts[treatmentinfo_dev$sample_id]
dim(gcount_dev) #columns should be 24
```

### Read normalization
We are now going normalize our read counts using VST-normalization in DESeq2

#### Construct the DESeq2 dataset

Merge the treatment and time_point columns into a new column , group. Set group as a factor.
```{r}
treatmentinfo_dev$time_point <- factor(treatmentinfo_dev$time_point, levels = c("Unfertilized_egg", "Fertilized_egg", "Cleavage", "Prawn_chip", "Early_gastrula", "Mid_gastrula", "Late_gastrula", "Planula", "Adult"))
```

Create a DESeqDataSet design from gene count matrix and labels. Here we set the design to look at time_point to test for any differences in gene expression across timepoints.
```{r}
#Set DESeq2 design
gdds_dev <- DESeqDataSetFromMatrix(countData = gcount_dev,
                              colData = treatmentinfo_dev,
                              design = ~time_point)
```

#### Log-transform the count data
First we are going to log-transform the data using a variance stabilizing transforamtion (VST). This is only for visualization purposes. Essentially, this is roughly similar to putting the data on the log2 scale. It will deal with the sampling variability of low counts by calculating within-group variability (if blind=FALSE). Importantly, it does not use the design to remove variation in the data, and so can be used to examine if there may be any variability do to technical factors such as extraction batch effects.

To do this we first need to calculate the size factors of our samples. This is a rough estimate of how many reads each sample contains compared to the others. In order to use VST (the faster log2 transforming process) to log-transform our data, the size factors need to be less than 4. Otherwise, there could be artefacts in our results.
```{r}
SF.gdds_dev <- estimateSizeFactors(gdds_dev) #estimate size factors to determine if we can use vst  to transform our data. Size factors should be less than for to use vst
print(sizeFactors(SF.gdds_dev)) #View size factors
```

Our size factors are all less than 4, so we can use VST!
```{r}
gvst_dev <- vst(gdds_dev, blind=FALSE) #apply a variance stabilizing transforamtion to minimize effects of small counts and normalize wrt library size
head(assay(gvst_dev), 3) #view transformed gene count data
```


## Run BLAST search of biomarkers against Mcap protein fasta

Find orthologues of biomarkers within Mcap genome
```{bash}
##Make blast database from Mcap predicted protein fasta file
#/usr/local/ncbi/blast/bin/makeblastdb -in Mcap.protein.fa -input_type fasta -dbtype prot -parse_seqids -out Mcap.protein.blast.db
#
##Blast fasta file containing sequences of selected biomarkers against our sequences
#/usr/local/ncbi/blast/bin/blastp -query MZT_biomarkers.fa -db Mcap.protein.blast.db -outfmt 6 -max_target_seqs 5 -evalue 1e-05 -out Mcap_Epi_MZT_biomarker_hits_5.tsv

#move BLAST output to project directory
```

Subset results for genes of interest
```{r}
hits <- read.table(file="2b-Epi-MZT-Enzyme-Expression/Output/Mcap_Epi_MZT_biomarker_hits_5.tsv", header=F, sep="\t")
colnames(hits) <- c("Epi.gene","queryprot", "gene_id", "pident", "length", "mismatch", "gapopen", "qstart", "qend", "sstart", "send", "evalue", "bitscore")
hits <- hits %>% distinct(Epi.gene, gene_id, .keep_all = TRUE)

countsx <- as.data.frame(assay(gvst_dev))
gene.counts <- countsx[(row.names(countsx) %in% hits$gene), ]
str(gene.counts)
gene.counts$gene_id <- row.names(gene.counts) 
gene.counts <- merge(gene.counts, hits[,c(1,3)], by="gene_id")

gene.counts.long <- pivot_longer(gene.counts, 2:25, values_to = "exp")
  #gather(gene.counts, group, exp, X1101:X375, factor_key=TRUE) 
colnames(gene.counts.long)[3] <- "sample_id"
gene.counts.long <- merge(gene.counts.long, sample.info[,c(1:2)], by="sample_id")
str(gene.counts.long)

mean.counts <- gene.counts.long %>%
  group_by(gene_id, Epi.gene, time_point) %>%
  summarise(mean = mean(exp),
            sd=sd(exp))

mean.counts$time_point <- factor(mean.counts$time_point, 
                                 levels = c("Unfertilized_egg","Fertilized_egg","Cleavage", 
                                  "Prawn_chip","Early_gastrula","Mid_gastrula", "Late_gastrula",
                                  "Planula", "Adult"))

DNMT3.counts <- subset(mean.counts, Epi.gene =="DNMT3A")
DNMT1.counts <- subset(mean.counts, Epi.gene =="DNMT1")
TET1.counts <- subset(mean.counts, Epi.gene =="TET1")
MBD2.counts <- subset(mean.counts, Epi.gene =="MBD2")
MBD3.counts <- subset(mean.counts, Epi.gene =="MBD3")
UHRF1.counts <- subset(mean.counts, Epi.gene =="UHRF1")
BRG1.counts <- subset(mean.counts, Epi.gene =="BRG1")
SMG.counts <- subset(mean.counts, Epi.gene =="SMG") #SMAUG
KAISO.counts <- subset(mean.counts, Epi.gene =="KAISO") #Kaiso
NANOG.counts <- subset(mean.counts, Epi.gene =="NANOG") #SNANOG
SOX2.counts <- subset(mean.counts, Epi.gene =="SOX2") #SOX2
WNT8.counts <- subset(mean.counts, Epi.gene =="WNT8") #WNT8
TBXT.counts <- subset(mean.counts, Epi.gene =="TBXT") #brachyury
```

## Plot methylation-related genes

Plot DNMT3a expression as a function of time and treatment
```{r}
Mcap.DNMT3 <- ggplot(DNMT3.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_blank(), #set x-axis title size
        axis.text.x=element_blank(), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_text(size = 14), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position=c(0.75, 0.9)) +
  ggtitle("i) DNMT3A homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.DNMT3
```

Plot DNMT1 expression as a function of time and treatment
```{r}
Mcap.DNMT1 <- ggplot(DNMT1.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean normalized expression"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_blank(), #set x-axis title size
        axis.text.x=element_blank(), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position=c(0.75, 0.9)) +
  ggtitle("ii) DNMT1 homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.DNMT1
```

Plot TET1 expression as a function of time and treatment
```{r}
Mcap.TET1 <- ggplot(TET1.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_blank(), #set x-axis title size
        axis.text.x=element_blank(), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position=c(0.75, 0.9)) +
  ggtitle("iii) TET1 homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.TET1
```

Plot MBD2 and MBD3 expression as a function of time and treatment
```{r}
Mcap.MBD2 <- ggplot(MBD2.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(shape=gene_id), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2, ) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_text(size = 14), #set x-axis title size
        axis.text.x=element_text(angle = 90, vjust = 0.5, hjust=1, size = 14), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_text(size = 14), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position=c(0.75, 0.9)) +
  ggtitle("iv) MBD2/3 homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.MBD2
```

Plot UHRF1 expression as a function of time and treatment
```{r}
Mcap.UHRF1 <- ggplot(UHRF1.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(shape=gene_id), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2, ) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_text(size = 14), #set x-axis title size
        axis.text.x=element_text(angle = 90, vjust = 0.5, hjust=1, size = 14), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position=c(0.75, 0.9)) +
  ggtitle("v) UHRF1 homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.UHRF1
```

Plot BRG1 expression as a function of time and treatment
```{r}
Mcap.BRG1 <- ggplot(BRG1.counts, aes(x=time_point, y=mean, group=gene_id)) +
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(shape=gene_id), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2, ) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_text(size = 14), #set x-axis title size
        axis.text.x=element_text(angle = 90, vjust = 0.5, hjust=1, size = 14), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position = c(0.75, 0.9)) +
  ggtitle("vi) BRG1 homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic',
                                  size = 18,
                                  hjust = 0))
Mcap.BRG1
```

Compile plots into single figure and save
```{r}
Fig.5 <- cowplot::plot_grid(Mcap.DNMT3, Mcap.DNMT1, Mcap.TET1, Mcap.MBD2, Mcap.UHRF1, Mcap.BRG1, align = "v", ncol = 3)
Fig.5
ggsave("2b-Epi-MZT-Enzyme-Expression/Output/Fig5-Mcap-Dev-Epi-Expression.pdf", Fig.5, width=21, height=15)
```

## Plot MZT biomarkers

Plot SMAUG expression as a function of time and treatment
```{r}
Mcap.SMG <- ggplot(SMG.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_blank(), #set x-axis title size
        axis.text.x=element_blank(), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_text(size = 14), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position = c(0.75, 0.9)) +
  ggtitle("i) SMAUG homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.SMG
```

Plot KAISO expression as a function of time and treatment
```{r}
Mcap.KAISO <- ggplot(KAISO.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_blank(), #set x-axis title size
        axis.text.x=element_blank(), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position = c(0.9, 0.9)) +
  ggtitle("ii) KAISO homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.KAISO
```

Plot TBXT expression as a function of time and treatment
```{r}
Mcap.TBXT <- ggplot(TBXT.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(shape=gene_id), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2, ) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
   theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_blank(), #set x-axis title size
        axis.text.x=element_blank(), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position = c(0.75, 0.9)) +
  ggtitle("iii) Brachyury (TBXT) homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.TBXT
```

Plot SOX2 expression as a function of time and treatment
```{r}
Mcap.SOX2 <- ggplot(SOX2.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(shape=gene_id), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2, ) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_text(size = 14), #set x-axis title size
        axis.text.x=element_text(angle = 90, vjust = 0.5, hjust=1, size = 14), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_text(size = 14), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position = c(0.75, 0.9)) +
  ggtitle("iv) SOX2 homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.SOX2
```

Plot NANOG expression as a function of time and treatment
```{r}
Mcap.NANOG <- ggplot(NANOG.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(shape=gene_id), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2, ) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
    theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_text(size = 14), #set x-axis title size
        axis.text.x=element_text(angle = 90, vjust = 0.5, hjust=1, size = 14), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position = c(0.75, 0.9)) +
  ggtitle("v) NANOG homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.NANOG
```

Plot WNT8 expression as a function of time and treatment
```{r}
Mcap.WNT8 <- ggplot(WNT8.counts, aes(x=time_point, y=mean, group=gene_id)) + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
  geom_line(aes(shape=gene_id), lty="dashed", color = "darkgrey") +
  geom_point(aes(shape=gene_id), size = 2) +
  xlab("Timepoint") +
  ylab(expression(paste("Mean expression (vst-transformed counts)"))) +
  theme_bw() + #Set the background color
  theme(axis.line = element_line(color = 'black'), #Set the axes color
        panel.border = element_blank(), #Set the border
        panel.grid.major = element_blank(), #Set the major gridlines
        panel.grid.minor = element_blank(), #Set the minor gridlines
        plot.background=element_blank(),  #Set the plot background
        axis.title.x=element_text(size = 14), #set x-axis title size
        axis.text.x=element_text(angle = 90, vjust = 0.5, hjust=1, size = 14), #set x-axis label size
        axis.text.y=element_text(size = 14), #set x-axis label size
        axis.title.y=element_blank(), #set x-axis label size
        axis.ticks.x=element_blank(), #No x-label ticks
        legend.text=element_text(size = 12), #Legend text size
        legend.position = c(0.918, 0.9)) +
  #guides(shape=guide_legend(ncol=3, nrow=2)) +
  ggtitle("vi) WNT8 homologs") +
  #facet_grid(rows=vars(gene_id), scales="free_y") +
  theme(strip.text.y = element_text(size = 5)) +
  theme(plot.title = element_text(face = 'bold.italic', 
                                  size = 18, 
                                  hjust = 0))
Mcap.WNT8
```

Compile plots into single figure and save
```{r}
Fig.6 <- cowplot::plot_grid(Mcap.SMG, Mcap.KAISO, Mcap.TBXT, Mcap.SOX2, Mcap.NANOG, Mcap.WNT8, align = "v", ncol = 3)
Fig.6
ggsave("2b-Epi-MZT-Enzyme-Expression/Output/Fig6-Mcap-Dev-MZT-Expression.pdf", Fig.6, width=21, height=14)
```

